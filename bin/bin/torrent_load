#!/usr/bin/env bash

HOST=192.168.1.222
PORT=8080

nc -zv $HOST $PORT  1>/dev/null 2>/dev/null

if [ $? -eq 0 ]
then
	echo "$HOST" online 
else
  echo "$HOST offline, waking"
  server_wake
fi

sleep 10

if [[ "$1" = magnet* ]]
then
	cd ~/Downloads/
	aria2c --bt-metadata-only=true --bt-save-metadata=true $1 
	file="$('ls' -tr1 . | tail -1 | grep \.torrent)"
	tput bel
	scp "${file}" johngodlee@$HOST:/media/hdd/torrents/
	rm "${file}"
elif [[ "$1" = *.torrent ]]
then
	tput bel
	scp "${1}" johngodlee@$HOST:/media/hdd/torrents/
else
	echo "Not a valid torrent"
fi



