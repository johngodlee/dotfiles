#!/usr/bin/env sh

# If tmux session ("dash") exists, attach to it, otherwise, build it

session="dash"

if (tmux has-session -t "$session" 2> /dev/null); then
	echo "Session already exists"
	sleep 2
	
	tmux a -t "$session"
else
	echo "Building session $session"
	sleep 2

	# Create new session
	tmux -2 new -s 'dash'

	# Start vim
	tmux send-keys "todo" Enter

	# New window, split into 4
	tmux new-window
	tmux split-window -v
	tmux split-window -h
	tmux select-pane -t 1
	tmux split-window -h

	# New window, start cmus
	tmux new-window 
	tmux send-keys "cmus" Enter

	# New window, start (neo)mutt 
	tmux new-window
	tmux send-keys "mutt" Enter

	# Detach and reattach to make it work properly
	tmux detach
	tmux a -t dash
	tmux select-window -t 1
fi
